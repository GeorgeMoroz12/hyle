---
import { getEntry } from 'astro:content';

// 1. Принимаем данные
const { item } = Astro.props;

// 2. Логика: ищем товар
let product = null;
let slug = null;

if (item) {
  const entry = await getEntry('products', item);
  if (entry) {
    product = entry.data;
    slug = entry.slug;
  }
}
---

{/* ВАРИАНТ 1: Ошибка (видна только при разработке) */}
{ !product && (
  <div class="my-4 p-2 border-l-2 border-red-500 bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300 font-mono text-xs">
    Product "{item}" not found.
  </div>
)}

{/* ВАРИАНТ 2: Минималистичный блок */}
{ product && (
  <div class="not-prose my-8 flex items-center gap-5 group">
    
    {/* Картинка: Компактная, без лишних оберток */}
    {product.images && product.images[0] && (
      <a href={`/products/${slug}`} class="shrink-0 w-20 h-20 overflow-hidden rounded-sm bg-neutral-100 dark:bg-white/5">
        <img 
          src={product.images[0]} 
          alt={product.title} 
          class="h-full w-full object-cover transition-transform duration-700 group-hover:scale-105"
        />
      </a>
    )}

    {/* Информация: Сжатая и четкая */}
    <div class="flex-1 min-w-0 flex flex-col justify-center gap-1">
      <a href={`/products/${slug}`} class="block">
        <h4 class="font-serif text-lg leading-tight text-neutral-900 dark:text-white truncate group-hover:text-[#B35A32] transition-colors">
          {product.title}
        </h4>
      </a>

      <div class="flex items-center gap-4">
        <span class="font-hand text-xl text-[#B35A32] dark:text-[#D68C5A] -rotate-1">
          {product.price} ₽
        </span>
        
        <a 
          href={`/products/${slug}`} 
          class="text-[10px] uppercase tracking-widest text-neutral-400 hover:text-neutral-900 dark:text-neutral-500 dark:hover:text-white transition-colors"
        >
          Купить →
        </a>
      </div>
    </div>

  </div>
)}